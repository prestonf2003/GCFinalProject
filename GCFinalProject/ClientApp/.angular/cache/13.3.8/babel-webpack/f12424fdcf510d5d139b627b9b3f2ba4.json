{"ast":null,"code":"import { User } from '../user';\nimport { Favorite } from '../favorite';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../character.service\";\nimport * as i2 from \"../dnd.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\n\nfunction MainViewComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"input\", 1);\n    i0.ɵɵlistener(\"ngModelChange\", function MainViewComponent_div_0_Template_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.userId = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"button\", 2);\n    i0.ɵɵlistener(\"click\", function MainViewComponent_div_0_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      ctx_r5.charService.login(ctx_r5.userId);\n      return ctx_r5.ngOnInit();\n    });\n    i0.ɵɵtext(3, \" Login \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.userId);\n  }\n}\n\nfunction MainViewComponent_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementStart(3, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function MainViewComponent_span_1_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      ctx_r6.charService.logout();\n      return ctx_r6.ngOnInit();\n    });\n    i0.ɵɵtext(4, \"Logout\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\")(6, \"br\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Logged in as: \", ctx_r1.currentUser, \" \");\n  }\n}\n\nfunction MainViewComponent_div_2_div_7_button_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function MainViewComponent_div_2_div_7_button_12_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const c_r9 = i0.ɵɵnextContext().$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return ctx_r12.createFavorite(c_r9.pkId);\n    });\n    i0.ɵɵtext(1, \"Favorite\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MainViewComponent_div_2_div_7_button_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function MainViewComponent_div_2_div_7_button_13_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r17);\n      const c_r9 = i0.ɵɵnextContext().$implicit;\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      return ctx_r15.deleteFavorite(c_r9.pkId);\n    });\n    i0.ɵɵtext(1, \"Remove from favorites\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction MainViewComponent_div_2_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"strong\")(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"p\", 6);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 2);\n    i0.ɵɵlistener(\"click\", function MainViewComponent_div_2_div_7_Template_button_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const c_r9 = restoredCtx.$implicit;\n      const ctx_r18 = i0.ɵɵnextContext(2);\n      return ctx_r18.deleteCharacter(c_r9.pkId);\n    });\n    i0.ɵɵtext(7, \"Delete Character\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \" \\u00A0 \\u00A0 \");\n    i0.ɵɵelementStart(9, \"button\", 2);\n    i0.ɵɵlistener(\"click\", function MainViewComponent_div_2_div_7_Template_button_click_9_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const c_r9 = restoredCtx.$implicit;\n      const ctx_r20 = i0.ɵɵnextContext(2);\n      return ctx_r20.updateCharacter(c_r9);\n    });\n    i0.ɵɵtext(10, \"Update Character\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\u00A0 \\u00A0 \");\n    i0.ɵɵtemplate(12, MainViewComponent_div_2_div_7_button_12_Template, 2, 0, \"button\", 7);\n    i0.ɵɵtemplate(13, MainViewComponent_div_2_div_7_button_13_Template, 2, 0, \"button\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const c_r9 = ctx.$implicit;\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"Class: \", c_r9.class, \"\\u00A0 \\u00A0 SubClass: \", c_r9.subclass, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r9.charisma);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.currentUser !== \"\" && !ctx_r8.isFavorited(c_r9.pkId));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r8.currentUser !== \"\" && ctx_r8.isFavorited(c_r9.pkId));\n  }\n}\n\nfunction MainViewComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"label\");\n    i0.ɵɵtext(2, \"Show only favorites: \");\n    i0.ɵɵelementStart(3, \"input\", 4);\n    i0.ɵɵlistener(\"click\", function MainViewComponent_div_2_Template_input_click_3_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return ctx_r21.GetCharacterByName(ctx_r21.name);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"favoritesOnly\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\")(6, \"br\");\n    i0.ɵɵtemplate(7, MainViewComponent_div_2_div_7_Template, 14, 5, \"div\", 5);\n    i0.ɵɵelement(8, \"br\")(9, \"br\");\n    i0.ɵɵelementStart(10, \"button\", 2);\n    i0.ɵɵlistener(\"click\", function MainViewComponent_div_2_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return ctx_r23.createCharacter();\n    });\n    i0.ɵɵtext(11, \"Create Character\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"br\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.searchedCharacters);\n  }\n}\n\nexport let MainViewComponent = /*#__PURE__*/(() => {\n  class MainViewComponent {\n    constructor(charService, dndService, router) {\n      this.charService = charService;\n      this.dndService = dndService;\n      this.router = router;\n      this.currentUser = this.charService.currentUser;\n      this.allCharacters = [];\n      this.favorites = [];\n      this.searchedCharacters = [];\n      this.newFavorite = new Favorite(-1, \"user here\", -1);\n      this.Class = '';\n      this.Subclass = '';\n      this.strength = 0;\n      this.dexterity = 0;\n      this.constitution = 0;\n      this.intelligence = 0;\n      this.wisdom = 0;\n      this.charisma = 0;\n      this.name = \"\";\n      this.pog = [];\n      this.favorited = [];\n      this.userId = \"\";\n      this.charService.showAllCharacters().subscribe(result => {\n        this.searchedCharacters = result;\n        console.log(this.searchedCharacters);\n      });\n      this.showAllFavorites();\n    }\n\n    createCharacter() {\n      this.router.navigateByUrl(`/create-character`);\n    }\n\n    createUser() {\n      let newUser = new User(undefined, this.userId);\n      this.charService.createUser(newUser).subscribe();\n    }\n\n    showAllFavorites() {\n      this.dndService.showFavorites().subscribe(allFavorites => {\n        this.favorites = allFavorites;\n      });\n    }\n\n    createFavorite(characterId) {\n      this.newFavorite = new Favorite(undefined, this.charService.currentUser, characterId);\n      this.dndService.createFavorite(this.newFavorite).subscribe(() => {\n        this.showAllFavorites();\n      });\n    }\n\n    deleteFavorite(characterId) {\n      let foundFav = this.favorites.find(favorite => favorite.id === characterId && favorite.userId === this.charService.currentUser);\n      this.dndService.deleteFavorite(foundFav.pkId).subscribe(() => {\n        this.favorites.splice(this.favorites.indexOf(foundFav), 1);\n      });\n    }\n\n    isFavorited(characterId) {\n      for (let i = 0; i < this.favorites.length; i++) {\n        if (this.favorites[i].id == characterId && this.favorites[i].userId === this.charService.currentUser) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    searchForFavorites() {\n      let newSearched = [];\n      newSearched = this.searchedCharacters.filter(character => this.isFavorited(character.pkId));\n      console.log(newSearched);\n      this.searchedCharacters = newSearched;\n    }\n\n    GetCharacterByName(name) {\n      var _a;\n\n      let searchByFaves = (_a = document.getElementById(\"favSearchCheckBox\")) !== null && _a !== void 0 ? _a : false;\n      this.charService.GetCharacterByName(name).subscribe(response => {\n        this.searchedCharacters = response;\n        console.log(name);\n\n        if (!searchByFaves.checked) {\n          this.searchForFavorites();\n        }\n      });\n    }\n\n    deleteCharacter(id) {\n      let toDelete = this.searchedCharacters.find(character => character.pkId == id);\n      this.charService.deleteCharacter(id).subscribe(() => {\n        this.searchedCharacters.splice(this.searchedCharacters.indexOf(toDelete), 1);\n      });\n    }\n\n    updateCharacter(character) {\n      this.charService.character = character;\n      this.router.navigateByUrl(`/view-preset`);\n    }\n\n    login() {\n      this.charService.login(this.userId);\n    }\n\n    ngOnInit() {\n      this.currentUser = this.charService.currentUser;\n      this.userId = '';\n    }\n\n  }\n\n  MainViewComponent.ɵfac = function MainViewComponent_Factory(t) {\n    return new (t || MainViewComponent)(i0.ɵɵdirectiveInject(i1.CharacterService), i0.ɵɵdirectiveInject(i2.DndService), i0.ɵɵdirectiveInject(i3.Router));\n  };\n\n  MainViewComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MainViewComponent,\n    selectors: [[\"app-main-view\"]],\n    decls: 3,\n    vars: 3,\n    consts: [[4, \"ngIf\"], [\"type\", \"text\", \"id\", \"username\", \"placeholder\", \"Username\", 3, \"ngModel\", \"ngModelChange\"], [3, \"click\"], [1, \"buttonStyle\", 3, \"click\"], [\"type\", \"checkbox\", \"id\", \"favSearchCheckBox\", \"value\", \"favoritesOnly\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [\"id\", \"stats\", 2, \"display\", \"none\"], [\"class\", \"buttonStyle\", 3, \"click\", 4, \"ngIf\"]],\n    template: function MainViewComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, MainViewComponent_div_0_Template, 4, 1, \"div\", 0);\n        i0.ɵɵtemplate(1, MainViewComponent_span_1_Template, 7, 1, \"span\", 0);\n        i0.ɵɵtemplate(2, MainViewComponent_div_2_Template, 13, 1, \"div\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.currentUser === \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.currentUser !== \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.currentUser !== \"\");\n      }\n    },\n    directives: [i4.NgIf, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel, i4.NgForOf],\n    styles: [\".body[_ngcontent-%COMP%]{text-align:center;background-image:linear-gradient(90deg,rgb(19,48,128),rgb(233,114,45) rgb(19,48,128))}\"]\n  });\n  return MainViewComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}