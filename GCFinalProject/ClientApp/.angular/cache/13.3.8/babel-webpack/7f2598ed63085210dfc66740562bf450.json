{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\pmanf\\\\Desktop\\\\Grand Circus\\\\unit9\\\\GCFinalProject\\\\GCFinalProject\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { Favorite } from '../favorite';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../dnd.service\";\nimport * as i2 from \"../character.service\";\nimport * as i3 from \"../toon-service.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\n\nfunction BattleComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"input\", 2);\n    i0.ɵɵlistener(\"ngModelChange\", function BattleComponent_div_0_Template_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return ctx_r2.userId = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"button\", 1);\n    i0.ɵɵlistener(\"click\", function BattleComponent_div_0_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r4 = i0.ɵɵnextContext();\n      ctx_r4.charService.login(ctx_r4.userId);\n      return ctx_r4.ngOnInit();\n    });\n    i0.ɵɵtext(3, \"Login\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.userId);\n  }\n}\n\nfunction BattleComponent_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵelement(1, \"br\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementStart(3, \"button\", 3);\n    i0.ɵɵlistener(\"click\", function BattleComponent_span_1_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      ctx_r5.charService.logout();\n      return ctx_r5.ngOnInit();\n    });\n    i0.ɵɵtext(4, \" Logout \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"br\")(6, \"br\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Logged in as: \", ctx_r1.currentUser, \" \");\n  }\n}\n\nexport let BattleComponent = /*#__PURE__*/(() => {\n  class BattleComponent {\n    constructor(dndService, charService, toonService) {\n      this.dndService = dndService;\n      this.charService = charService;\n      this.toonService = toonService;\n      this.favorites = [];\n      this.searchedCharacters = [];\n      this.currentUser = this.charService.currentUser;\n      this.name = '';\n      this.newFavorite = new Favorite(-1, 'user here', -1);\n      this.userId = '';\n      this.userHealth = 20;\n      this.cartoonHealth = 25;\n      this.attack_user = 0;\n      this.attack_cartoon = 0;\n      this.Victory = ''; // currentToon = this.cartoonChar.cartSearch;\n      // currentFavorite = this.cartoonChar.favSearch;\n\n      this.favSearch = this.toonService.favSearch;\n      this.cartSearch = this.toonService.cartSearch;\n      this.charService.showAllCharacters().subscribe(result => {\n        this.searchedCharacters = result;\n        console.log(this.searchedCharacters);\n      });\n      this.showAllFavorites();\n    }\n\n    showAllFavorites() {\n      this.dndService.showFavorites().subscribe(allFavorites => {\n        this.favorites = allFavorites;\n      });\n    }\n\n    GetCharacterByName(name) {\n      var _a;\n\n      let searchByFaves = (_a = document.getElementById('favSearchCheckBox')) !== null && _a !== void 0 ? _a : false;\n      this.charService.GetCharacterByName(name).subscribe(response => {\n        this.searchedCharacters = response;\n        console.log(this.searchedCharacters);\n        console.log(this.currentUser);\n\n        if (!searchByFaves.checked) {\n          this.searchForFavorites();\n        }\n      });\n    }\n\n    searchForFavorites() {\n      let newSearched = [];\n      newSearched = this.searchedCharacters.filter(character => this.isFavorited(character.pkId));\n      console.log(newSearched);\n      this.searchedCharacters = newSearched;\n    }\n\n    isFavorited(characterId) {\n      for (let i = 0; i < this.favorites.length; i++) {\n        if (this.favorites[i].id == characterId && this.favorites[i].userId === this.charService.currentUser) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    createFavorite(characterId) {\n      this.newFavorite = new Favorite(undefined, this.charService.currentUser, characterId);\n      this.dndService.createFavorite(this.newFavorite).subscribe(() => {\n        this.showAllFavorites();\n      });\n    }\n\n    deleteFavorite(characterId) {\n      let foundFav = this.favorites.find(favorite => favorite.id === characterId && favorite.userId === this.charService.currentUser);\n      this.dndService.deleteFavorite(foundFav.pkId).subscribe(() => {\n        this.favorites.splice(this.favorites.indexOf(foundFav), 1);\n      });\n    }\n\n    getCartoonAttack() {\n      return Math.floor(Math.random() * (10 - 1)) + 1;\n    }\n\n    getUserAttack() {\n      return Math.floor(Math.random() * (10 - 1)) + 1;\n    }\n\n    delay(ms) {\n      return new Promise(resolve => setTimeout(resolve, ms));\n    }\n\n    BattleItOut() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        _this.userHealth = 20;\n        _this.cartoonHealth = 25;\n        let defeated = false;\n\n        while (defeated === false) {\n          let Cartoonattack = _this.getCartoonAttack();\n\n          _this.attack_cartoon = Cartoonattack;\n          _this.userHealth = _this.userHealth - Cartoonattack;\n\n          let Userattack = _this.getUserAttack();\n\n          _this.attack_user = Userattack;\n          _this.cartoonHealth = _this.cartoonHealth - Userattack;\n          yield _this.delay(1000);\n\n          if (_this.userHealth <= 0) {\n            if (_this.userHealth < 0) {\n              _this.userHealth = 0;\n            }\n\n            _this.Victory = \"You Got smacked by \" + _this.cartSearch;\n            defeated = true;\n          }\n\n          if (_this.cartoonHealth <= 0) {\n            if (_this.cartoonHealth < 0) {\n              _this.cartoonHealth = 0;\n            }\n\n            _this.Victory = \"Congratulations!\" + _this.currentUser + \"You beat\" + _this.cartSearch;\n            defeated = true;\n          }\n        }\n      })();\n    }\n\n    ngOnInit() {\n      this.currentUser = this.charService.currentUser;\n      this.userId = '';\n      this.GetCharacterByName('');\n      this.favSearch = this.toonService.favSearch;\n      this.cartSearch = this.toonService.cartSearch;\n    }\n\n  }\n\n  BattleComponent.ɵfac = function BattleComponent_Factory(t) {\n    return new (t || BattleComponent)(i0.ɵɵdirectiveInject(i1.DndService), i0.ɵɵdirectiveInject(i2.CharacterService), i0.ɵɵdirectiveInject(i3.ToonServiceService));\n  };\n\n  BattleComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: BattleComponent,\n    selectors: [[\"app-battle\"]],\n    decls: 9,\n    vars: 9,\n    consts: [[4, \"ngIf\"], [3, \"click\"], [\"type\", \"text\", \"id\", \"username\", \"placeholder\", \"Username\", 3, \"ngModel\", \"ngModelChange\"], [1, \"buttonStyle\", 3, \"click\"]],\n    template: function BattleComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, BattleComponent_div_0_Template, 4, 1, \"div\", 0);\n        i0.ɵɵtemplate(1, BattleComponent_span_1_Template, 7, 1, \"span\", 0);\n        i0.ɵɵtext(2);\n        i0.ɵɵelementStart(3, \"p\");\n        i0.ɵɵtext(4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"p\");\n        i0.ɵɵtext(6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function BattleComponent_Template_button_click_7_listener() {\n          return ctx.BattleItOut();\n        });\n        i0.ɵɵtext(8, \"Battle\");\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.currentUser === \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.currentUser !== \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate2(\" \", ctx.cartSearch, \" \", ctx.favSearch, \"\\n\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate4(\" User Health:\", ctx.userHealth, \" User Attack:\", ctx.attack_user, \" \\u00A0 \\u00A0 Cartoon Health:\", ctx.cartoonHealth, \" Cartoon Attack:\", ctx.attack_cartoon, \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.Victory);\n      }\n    },\n    directives: [i4.NgIf, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgModel],\n    styles: [\"\"]\n  });\n  return BattleComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}